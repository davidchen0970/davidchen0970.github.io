<!DOCTYPE html>
<html lang="zh-tw" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" /><meta
name='description' content=" 將 yuc420 的畫質改善成 yuv444 希望可以提供更好的觀看品質 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 import torch import torch.nn as nn import torch.optim as optim from torch.utils.data import DataLoader, Dataset import numpy as np import cv2 import os # 提取多部影片幀的函數 def extract_frames_from_videos(video_dir, output_dir, img_size=(256, 256)): &#34;&#34;&#34; 從多部影片中提取幀並保存為 .yuv420 格式。 :param video_dir: 包含影片的目錄。 :param output_dir: 保存幀的目錄。 :param img_size: 提取幀的尺寸 (H, W)。 &#34;&#34;&#34; os.makedirs(output_dir, exist_ok=True) video_files = [f for f in os.listdir(video_dir) if f.endswith((&#39;.mp4&#39;, &#39;.avi&#39;, &#39;.mov&#39;))] frame_count = 0 for video_file in video_files: video_path = os.path.join(video_dir, video_file) cap = cv2.VideoCapture(video_path) video_name = os.path.splitext(video_file)[0] video_output_dir = os.path.join(output_dir, video_name) os.makedirs(video_output_dir, exist_ok=True) while cap.isOpened(): ret, frame = cap.read() if not ret: break # Resize and convert frame frame_resized = cv2.resize(frame, img_size) yuv_frame = cv2.cvtColor(frame_resized, cv2.COLOR_BGR2YUV_I420) y_size = img_size[0] * img_size[1] uv_size = y_size // 4 y = yuv_frame[:y_size] u = yuv_frame[y_size:y_size + uv_size] v = yuv_frame[y_size + uv_size:] # Save frame as .yuv420 frame_path = os.path.join(video_output_dir, f&#34;frame_{frame_count:05d}.yuv420&#34;) with open(frame_path, &#39;wb&#39;) as f: f.write(y.tobytes()) f.write(u.tobytes()) f.write(v.tobytes()) frame_count += 1 cap.release() print(f&#34;Extracted frames from {video_file} to {video_output_dir}&#34;) print(f&#34;Total frames extracted: {frame_count}&#34;) # 數據集類別 class VideoYUV420Dataset(Dataset): def __init__(self, yuv420_dir, img_size=(256, 256)): &#34;&#34;&#34; 數據集初始化。 :param yuv420_dir: 包含 .yuv420 文件的目錄。 :param img_size: 圖像尺寸 (H, W)。 &#34;&#34;&#34; self.yuv420_dir = yuv420_dir self.img_size = img_size self.filenames = [] for root, _, files in os.walk(yuv420_dir): for file in files: if file.endswith(&#39;.yuv420&#39;): self.filenames.append(os.path.join(root, file)) def __len__(self): return len(self.filenames) def __getitem__(self, idx): yuv420_path = self.filenames[idx] y_channel, uv_channel = self.load_yuv420(yuv420_path, self.img_size) # Generate a pseudo label (e.g., repeat YUV420 as placeholder for YUV444) yuv444_label = torch.cat((y_channel, uv_channel), dim=0) # For demo purposes return (y_channel, uv_channel), yuv444_label @staticmethod def load_yuv420(yuv420_path, img_size): with open(yuv420_path, &#39;rb&#39;) as f: y_size = img_size[0] * img_size[1] uv_size = y_size // 4 y = np.frombuffer(f.read(y_size), dtype=np.uint8).reshape(img_size) u = np.frombuffer(f.read(uv_size), dtype=np.uint8).reshape((img_size[0] // 2, img_size[1] // 2)) v = np.frombuffer(f.read(uv_size), dtype=np.uint8).reshape((img_size[0] // 2, img_size[1] // 2)) y_tensor = torch.tensor(y, dtype=torch.float32).unsqueeze(0) / 255.0 uv_tensor = torch.tensor(np.stack([u, v], axis=0), dtype=torch.float32) / 255.0 return y_tensor, uv_tensor # 模型定義 class YUV420ToYUV444Model(nn.Module): def __init__(self): super(YUV420ToYUV444Model, self).__init__() # UV 通道的上採樣層 self.upsample_uv = nn.Sequential( nn.Conv2d(2, 64, kernel_size=3, stride=1, padding=1), nn.ReLU(), nn.Conv2d(64, 64, kernel_size=3, stride=1, padding=1), nn.ReLU(), nn.Conv2d(64, 2, kernel_size=3, stride=1, padding=1), ) def forward(self, y_channel, uv_channel): &#34;&#34;&#34; y_channel: shape (B, 1, H, W) uv_channel: shape (B, 2, H//2, W//2) &#34;&#34;&#34; # 上採樣 UV 通道 uv_upsampled = torch.nn.functional.interpolate( uv_channel, scale_factor=2, mode=&#39;bilinear&#39;, align_corners=False ) uv_refined = self.upsample_uv(uv_upsampled) # 合併 Y 和 UV 通道 yuv_444 = torch.cat((y_channel, uv_refined), dim=1) return yuv_444 # 訓練函數 def train_model(model, dataloader, criterion, optimizer, num_epochs=10, device=&#39;cuda&#39;): model.to(device) for epoch in range(num_epochs): model.train() running_loss = 0.0 for (y_channel, uv_channel), yuv444_label in dataloader: y_channel, uv_channel, yuv444_label = ( y_channel.to(device), uv_channel.to(device), yuv444_label.to(device), ) # 前向傳播 outputs = model(y_channel, uv_channel) loss = criterion(outputs, yuv444_label) # 反向傳播與優化 optimizer.zero_grad() loss.backward() optimizer.step() running_loss += loss.item() avg_loss = running_loss / len(dataloader) print(f&#34;Epoch [{epoch + 1}/{num_epochs}], Loss: {avg_loss:.4f}&#34;) # 主程式 if __name__ == &#34;__main__&#34;: # 設置路徑 video_dir = &#34;videos&#34; # 包含影片的目錄 yuv420_dir = &#34;./frames&#34; # 保存提取幀的目錄 # 提取影片幀 extract_frames_from_videos(video_dir, yuv420_dir) # 加載數據集 dataset = VideoYUV420Dataset(yuv420_dir) dataloader = DataLoader(dataset, batch_size=8, shuffle=True) # 定義模型、損失函數與優化器 model = YUV420ToYUV444Model() criterion = nn.MSELoss() optimizer = optim.Adam(model.parameters(), lr=1e-4) # 訓練模型 train_model(model, dataloader, criterion, optimizer, num_epochs=20) "> <title>Draft</title>

<link rel="canonical" href="http://localhost:1313/p/draft/" />

<link rel="stylesheet" href="/scss/style.min.f434d313da649fc0b1a71e21d919392bcd084abff46389bbfb1f82b7f8d130aa.css"><meta property='og:title' content="Draft">
<meta property='og:description' content=" 將 yuc420 的畫質改善成 yuv444 希望可以提供更好的觀看品質 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 import torch import torch.nn as nn import torch.optim as optim from torch.utils.data import DataLoader, Dataset import numpy as np import cv2 import os # 提取多部影片幀的函數 def extract_frames_from_videos(video_dir, output_dir, img_size=(256, 256)): &#34;&#34;&#34; 從多部影片中提取幀並保存為 .yuv420 格式。 :param video_dir: 包含影片的目錄。 :param output_dir: 保存幀的目錄。 :param img_size: 提取幀的尺寸 (H, W)。 &#34;&#34;&#34; os.makedirs(output_dir, exist_ok=True) video_files = [f for f in os.listdir(video_dir) if f.endswith((&#39;.mp4&#39;, &#39;.avi&#39;, &#39;.mov&#39;))] frame_count = 0 for video_file in video_files: video_path = os.path.join(video_dir, video_file) cap = cv2.VideoCapture(video_path) video_name = os.path.splitext(video_file)[0] video_output_dir = os.path.join(output_dir, video_name) os.makedirs(video_output_dir, exist_ok=True) while cap.isOpened(): ret, frame = cap.read() if not ret: break # Resize and convert frame frame_resized = cv2.resize(frame, img_size) yuv_frame = cv2.cvtColor(frame_resized, cv2.COLOR_BGR2YUV_I420) y_size = img_size[0] * img_size[1] uv_size = y_size // 4 y = yuv_frame[:y_size] u = yuv_frame[y_size:y_size + uv_size] v = yuv_frame[y_size + uv_size:] # Save frame as .yuv420 frame_path = os.path.join(video_output_dir, f&#34;frame_{frame_count:05d}.yuv420&#34;) with open(frame_path, &#39;wb&#39;) as f: f.write(y.tobytes()) f.write(u.tobytes()) f.write(v.tobytes()) frame_count += 1 cap.release() print(f&#34;Extracted frames from {video_file} to {video_output_dir}&#34;) print(f&#34;Total frames extracted: {frame_count}&#34;) # 數據集類別 class VideoYUV420Dataset(Dataset): def __init__(self, yuv420_dir, img_size=(256, 256)): &#34;&#34;&#34; 數據集初始化。 :param yuv420_dir: 包含 .yuv420 文件的目錄。 :param img_size: 圖像尺寸 (H, W)。 &#34;&#34;&#34; self.yuv420_dir = yuv420_dir self.img_size = img_size self.filenames = [] for root, _, files in os.walk(yuv420_dir): for file in files: if file.endswith(&#39;.yuv420&#39;): self.filenames.append(os.path.join(root, file)) def __len__(self): return len(self.filenames) def __getitem__(self, idx): yuv420_path = self.filenames[idx] y_channel, uv_channel = self.load_yuv420(yuv420_path, self.img_size) # Generate a pseudo label (e.g., repeat YUV420 as placeholder for YUV444) yuv444_label = torch.cat((y_channel, uv_channel), dim=0) # For demo purposes return (y_channel, uv_channel), yuv444_label @staticmethod def load_yuv420(yuv420_path, img_size): with open(yuv420_path, &#39;rb&#39;) as f: y_size = img_size[0] * img_size[1] uv_size = y_size // 4 y = np.frombuffer(f.read(y_size), dtype=np.uint8).reshape(img_size) u = np.frombuffer(f.read(uv_size), dtype=np.uint8).reshape((img_size[0] // 2, img_size[1] // 2)) v = np.frombuffer(f.read(uv_size), dtype=np.uint8).reshape((img_size[0] // 2, img_size[1] // 2)) y_tensor = torch.tensor(y, dtype=torch.float32).unsqueeze(0) / 255.0 uv_tensor = torch.tensor(np.stack([u, v], axis=0), dtype=torch.float32) / 255.0 return y_tensor, uv_tensor # 模型定義 class YUV420ToYUV444Model(nn.Module): def __init__(self): super(YUV420ToYUV444Model, self).__init__() # UV 通道的上採樣層 self.upsample_uv = nn.Sequential( nn.Conv2d(2, 64, kernel_size=3, stride=1, padding=1), nn.ReLU(), nn.Conv2d(64, 64, kernel_size=3, stride=1, padding=1), nn.ReLU(), nn.Conv2d(64, 2, kernel_size=3, stride=1, padding=1), ) def forward(self, y_channel, uv_channel): &#34;&#34;&#34; y_channel: shape (B, 1, H, W) uv_channel: shape (B, 2, H//2, W//2) &#34;&#34;&#34; # 上採樣 UV 通道 uv_upsampled = torch.nn.functional.interpolate( uv_channel, scale_factor=2, mode=&#39;bilinear&#39;, align_corners=False ) uv_refined = self.upsample_uv(uv_upsampled) # 合併 Y 和 UV 通道 yuv_444 = torch.cat((y_channel, uv_refined), dim=1) return yuv_444 # 訓練函數 def train_model(model, dataloader, criterion, optimizer, num_epochs=10, device=&#39;cuda&#39;): model.to(device) for epoch in range(num_epochs): model.train() running_loss = 0.0 for (y_channel, uv_channel), yuv444_label in dataloader: y_channel, uv_channel, yuv444_label = ( y_channel.to(device), uv_channel.to(device), yuv444_label.to(device), ) # 前向傳播 outputs = model(y_channel, uv_channel) loss = criterion(outputs, yuv444_label) # 反向傳播與優化 optimizer.zero_grad() loss.backward() optimizer.step() running_loss += loss.item() avg_loss = running_loss / len(dataloader) print(f&#34;Epoch [{epoch + 1}/{num_epochs}], Loss: {avg_loss:.4f}&#34;) # 主程式 if __name__ == &#34;__main__&#34;: # 設置路徑 video_dir = &#34;videos&#34; # 包含影片的目錄 yuv420_dir = &#34;./frames&#34; # 保存提取幀的目錄 # 提取影片幀 extract_frames_from_videos(video_dir, yuv420_dir) # 加載數據集 dataset = VideoYUV420Dataset(yuv420_dir) dataloader = DataLoader(dataset, batch_size=8, shuffle=True) # 定義模型、損失函數與優化器 model = YUV420ToYUV444Model() criterion = nn.MSELoss() optimizer = optim.Adam(model.parameters(), lr=1e-4) # 訓練模型 train_model(model, dataloader, criterion, optimizer, num_epochs=20) ">
<meta property='og:url' content='http://localhost:1313/p/draft/'>
<meta property='og:site_name' content='歡迎光臨我家'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2024-12-10T21:20:55&#43;08:00'/><meta property='article:modified_time' content='2024-12-10T21:20:55&#43;08:00'/>
<meta name="twitter:title" content="Draft">
<meta name="twitter:description" content=" 將 yuc420 的畫質改善成 yuv444 希望可以提供更好的觀看品質 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 import torch import torch.nn as nn import torch.optim as optim from torch.utils.data import DataLoader, Dataset import numpy as np import cv2 import os # 提取多部影片幀的函數 def extract_frames_from_videos(video_dir, output_dir, img_size=(256, 256)): &#34;&#34;&#34; 從多部影片中提取幀並保存為 .yuv420 格式。 :param video_dir: 包含影片的目錄。 :param output_dir: 保存幀的目錄。 :param img_size: 提取幀的尺寸 (H, W)。 &#34;&#34;&#34; os.makedirs(output_dir, exist_ok=True) video_files = [f for f in os.listdir(video_dir) if f.endswith((&#39;.mp4&#39;, &#39;.avi&#39;, &#39;.mov&#39;))] frame_count = 0 for video_file in video_files: video_path = os.path.join(video_dir, video_file) cap = cv2.VideoCapture(video_path) video_name = os.path.splitext(video_file)[0] video_output_dir = os.path.join(output_dir, video_name) os.makedirs(video_output_dir, exist_ok=True) while cap.isOpened(): ret, frame = cap.read() if not ret: break # Resize and convert frame frame_resized = cv2.resize(frame, img_size) yuv_frame = cv2.cvtColor(frame_resized, cv2.COLOR_BGR2YUV_I420) y_size = img_size[0] * img_size[1] uv_size = y_size // 4 y = yuv_frame[:y_size] u = yuv_frame[y_size:y_size + uv_size] v = yuv_frame[y_size + uv_size:] # Save frame as .yuv420 frame_path = os.path.join(video_output_dir, f&#34;frame_{frame_count:05d}.yuv420&#34;) with open(frame_path, &#39;wb&#39;) as f: f.write(y.tobytes()) f.write(u.tobytes()) f.write(v.tobytes()) frame_count += 1 cap.release() print(f&#34;Extracted frames from {video_file} to {video_output_dir}&#34;) print(f&#34;Total frames extracted: {frame_count}&#34;) # 數據集類別 class VideoYUV420Dataset(Dataset): def __init__(self, yuv420_dir, img_size=(256, 256)): &#34;&#34;&#34; 數據集初始化。 :param yuv420_dir: 包含 .yuv420 文件的目錄。 :param img_size: 圖像尺寸 (H, W)。 &#34;&#34;&#34; self.yuv420_dir = yuv420_dir self.img_size = img_size self.filenames = [] for root, _, files in os.walk(yuv420_dir): for file in files: if file.endswith(&#39;.yuv420&#39;): self.filenames.append(os.path.join(root, file)) def __len__(self): return len(self.filenames) def __getitem__(self, idx): yuv420_path = self.filenames[idx] y_channel, uv_channel = self.load_yuv420(yuv420_path, self.img_size) # Generate a pseudo label (e.g., repeat YUV420 as placeholder for YUV444) yuv444_label = torch.cat((y_channel, uv_channel), dim=0) # For demo purposes return (y_channel, uv_channel), yuv444_label @staticmethod def load_yuv420(yuv420_path, img_size): with open(yuv420_path, &#39;rb&#39;) as f: y_size = img_size[0] * img_size[1] uv_size = y_size // 4 y = np.frombuffer(f.read(y_size), dtype=np.uint8).reshape(img_size) u = np.frombuffer(f.read(uv_size), dtype=np.uint8).reshape((img_size[0] // 2, img_size[1] // 2)) v = np.frombuffer(f.read(uv_size), dtype=np.uint8).reshape((img_size[0] // 2, img_size[1] // 2)) y_tensor = torch.tensor(y, dtype=torch.float32).unsqueeze(0) / 255.0 uv_tensor = torch.tensor(np.stack([u, v], axis=0), dtype=torch.float32) / 255.0 return y_tensor, uv_tensor # 模型定義 class YUV420ToYUV444Model(nn.Module): def __init__(self): super(YUV420ToYUV444Model, self).__init__() # UV 通道的上採樣層 self.upsample_uv = nn.Sequential( nn.Conv2d(2, 64, kernel_size=3, stride=1, padding=1), nn.ReLU(), nn.Conv2d(64, 64, kernel_size=3, stride=1, padding=1), nn.ReLU(), nn.Conv2d(64, 2, kernel_size=3, stride=1, padding=1), ) def forward(self, y_channel, uv_channel): &#34;&#34;&#34; y_channel: shape (B, 1, H, W) uv_channel: shape (B, 2, H//2, W//2) &#34;&#34;&#34; # 上採樣 UV 通道 uv_upsampled = torch.nn.functional.interpolate( uv_channel, scale_factor=2, mode=&#39;bilinear&#39;, align_corners=False ) uv_refined = self.upsample_uv(uv_upsampled) # 合併 Y 和 UV 通道 yuv_444 = torch.cat((y_channel, uv_refined), dim=1) return yuv_444 # 訓練函數 def train_model(model, dataloader, criterion, optimizer, num_epochs=10, device=&#39;cuda&#39;): model.to(device) for epoch in range(num_epochs): model.train() running_loss = 0.0 for (y_channel, uv_channel), yuv444_label in dataloader: y_channel, uv_channel, yuv444_label = ( y_channel.to(device), uv_channel.to(device), yuv444_label.to(device), ) # 前向傳播 outputs = model(y_channel, uv_channel) loss = criterion(outputs, yuv444_label) # 反向傳播與優化 optimizer.zero_grad() loss.backward() optimizer.step() running_loss += loss.item() avg_loss = running_loss / len(dataloader) print(f&#34;Epoch [{epoch + 1}/{num_epochs}], Loss: {avg_loss:.4f}&#34;) # 主程式 if __name__ == &#34;__main__&#34;: # 設置路徑 video_dir = &#34;videos&#34; # 包含影片的目錄 yuv420_dir = &#34;./frames&#34; # 保存提取幀的目錄 # 提取影片幀 extract_frames_from_videos(video_dir, yuv420_dir) # 加載數據集 dataset = VideoYUV420Dataset(yuv420_dir) dataloader = DataLoader(dataset, batch_size=8, shuffle=True) # 定義模型、損失函數與優化器 model = YUV420ToYUV444Model() criterion = nn.MSELoss() optimizer = optim.Adam(model.parameters(), lr=1e-4) # 訓練模型 train_model(model, dataloader, criterion, optimizer, num_epochs=20) "><script src="/js/external-image-resize.js"></script>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切換選單">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_63954bea4f492758.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">🍥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">歡迎光臨我家</a></h1>
            <h2 class="site-description">施工中，施工中...</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/davidchen0970/'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://instagram.com'
                        target="_blank"
                        title="instagram"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" encoding="utf-8"?><!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg fill="rgb(216, 220, 221)"  width="800px" height="800px" viewBox="16 16 224 224" id="Flat" xmlns="http://www.w3.org/2000/svg">
  <path d="M128,84a44,44,0,1,0,44,44A44.04978,44.04978,0,0,0,128,84Zm0,80a36,36,0,1,1,36-36A36.04061,36.04061,0,0,1,128,164ZM172,32H84A52.059,52.059,0,0,0,32,84v88a52.059,52.059,0,0,0,52,52h88a52.059,52.059,0,0,0,52-52V84A52.059,52.059,0,0,0,172,32Zm44,140a44.04978,44.04978,0,0,1-44,44H84a44.04978,44.04978,0,0,1-44-44V84A44.04978,44.04978,0,0,1,84,40h88a44.04978,44.04978,0,0,1,44,44ZM188,76a8,8,0,1,1-8-8A8.00917,8.00917,0,0,1,188,76Z"/>
</svg>

<!-- reference : https://www.svgrepo.com/svg/365495/instagram-logo-thin -->
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>首頁</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E9%97%9C%E6%96%BC/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>關於</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>檔案</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="http://localhost:1313/" selected>正體中文</option>
                                
                                    <option value="http://localhost:1313/en/" >English</option>
                                
                                    <option value="http://localhost:1313/zh-cn/" >简体中文</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>深色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    

            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/draft/">Draft</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Dec 10, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    閱讀時間: 4 分鐘
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <ul>
<li>將 yuc420 的畫質改善成 yuv444
希望可以提供更好的觀看品質</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">Dataset</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">cv2</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 提取多部影片幀的函數</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">extract_frames_from_videos</span><span class="p">(</span><span class="n">video_dir</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span> <span class="n">img_size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    從多部影片中提取幀並保存為 .yuv420 格式。
</span></span></span><span class="line"><span class="cl"><span class="s2">    :param video_dir: 包含影片的目錄。
</span></span></span><span class="line"><span class="cl"><span class="s2">    :param output_dir: 保存幀的目錄。
</span></span></span><span class="line"><span class="cl"><span class="s2">    :param img_size: 提取幀的尺寸 (H, W)。
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">video_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">video_dir</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.mp4&#39;</span><span class="p">,</span> <span class="s1">&#39;.avi&#39;</span><span class="p">,</span> <span class="s1">&#39;.mov&#39;</span><span class="p">))]</span>
</span></span><span class="line"><span class="cl">    <span class="n">frame_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">video_file</span> <span class="ow">in</span> <span class="n">video_files</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">video_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">video_dir</span><span class="p">,</span> <span class="n">video_file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="n">video_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">video_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">video_file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">video_output_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">video_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">video_output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">cap</span><span class="o">.</span><span class="n">isOpened</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="n">ret</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Resize and convert frame</span>
</span></span><span class="line"><span class="cl">            <span class="n">frame_resized</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">img_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">yuv_frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame_resized</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2YUV_I420</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">y_size</span> <span class="o">=</span> <span class="n">img_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">img_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">uv_size</span> <span class="o">=</span> <span class="n">y_size</span> <span class="o">//</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">            <span class="n">y</span> <span class="o">=</span> <span class="n">yuv_frame</span><span class="p">[:</span><span class="n">y_size</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">u</span> <span class="o">=</span> <span class="n">yuv_frame</span><span class="p">[</span><span class="n">y_size</span><span class="p">:</span><span class="n">y_size</span> <span class="o">+</span> <span class="n">uv_size</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span> <span class="o">=</span> <span class="n">yuv_frame</span><span class="p">[</span><span class="n">y_size</span> <span class="o">+</span> <span class="n">uv_size</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># Save frame as .yuv420</span>
</span></span><span class="line"><span class="cl">            <span class="n">frame_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">video_output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;frame_</span><span class="si">{</span><span class="n">frame_count</span><span class="si">:</span><span class="s2">05d</span><span class="si">}</span><span class="s2">.yuv420&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">frame_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="n">frame_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">cap</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Extracted frames from </span><span class="si">{</span><span class="n">video_file</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">video_output_dir</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Total frames extracted: </span><span class="si">{</span><span class="n">frame_count</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 數據集類別</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">VideoYUV420Dataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yuv420_dir</span><span class="p">,</span> <span class="n">img_size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        數據集初始化。
</span></span></span><span class="line"><span class="cl"><span class="s2">        :param yuv420_dir: 包含 .yuv420 文件的目錄。
</span></span></span><span class="line"><span class="cl"><span class="s2">        :param img_size: 圖像尺寸 (H, W)。
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">yuv420_dir</span> <span class="o">=</span> <span class="n">yuv420_dir</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">img_size</span> <span class="o">=</span> <span class="n">img_size</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">yuv420_dir</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.yuv420&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">yuv420_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">y_channel</span><span class="p">,</span> <span class="n">uv_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_yuv420</span><span class="p">(</span><span class="n">yuv420_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">img_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Generate a pseudo label (e.g., repeat YUV420 as placeholder for YUV444)</span>
</span></span><span class="line"><span class="cl">        <span class="n">yuv444_label</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">y_channel</span><span class="p">,</span> <span class="n">uv_channel</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># For demo purposes</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="n">y_channel</span><span class="p">,</span> <span class="n">uv_channel</span><span class="p">),</span> <span class="n">yuv444_label</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@staticmethod</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">load_yuv420</span><span class="p">(</span><span class="n">yuv420_path</span><span class="p">,</span> <span class="n">img_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">yuv420_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">y_size</span> <span class="o">=</span> <span class="n">img_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">img_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">uv_size</span> <span class="o">=</span> <span class="n">y_size</span> <span class="o">//</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">y_size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">img_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">uv_size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">img_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">img_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">uv_size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">img_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">img_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">y_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
</span></span><span class="line"><span class="cl">        <span class="n">uv_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">y_tensor</span><span class="p">,</span> <span class="n">uv_tensor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 模型定義</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">YUV420ToYUV444Model</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">(</span><span class="n">YUV420ToYUV444Model</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># UV 通道的上採樣層</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">upsample_uv</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_channel</span><span class="p">,</span> <span class="n">uv_channel</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        y_channel: shape (B, 1, H, W)
</span></span></span><span class="line"><span class="cl"><span class="s2">        uv_channel: shape (B, 2, H//2, W//2)
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 上採樣 UV 通道</span>
</span></span><span class="line"><span class="cl">        <span class="n">uv_upsampled</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">uv_channel</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span> <span class="n">align_corners</span><span class="o">=</span><span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">uv_refined</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upsample_uv</span><span class="p">(</span><span class="n">uv_upsampled</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># 合併 Y 和 UV 通道</span>
</span></span><span class="line"><span class="cl">        <span class="n">yuv_444</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">y_channel</span><span class="p">,</span> <span class="n">uv_refined</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">yuv_444</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 訓練函數</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="n">y_channel</span><span class="p">,</span> <span class="n">uv_channel</span><span class="p">),</span> <span class="n">yuv444_label</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">y_channel</span><span class="p">,</span> <span class="n">uv_channel</span><span class="p">,</span> <span class="n">yuv444_label</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">y_channel</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="n">uv_channel</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="n">yuv444_label</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 前向傳播</span>
</span></span><span class="line"><span class="cl">            <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">y_channel</span><span class="p">,</span> <span class="n">uv_channel</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">yuv444_label</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 反向傳播與優化</span>
</span></span><span class="line"><span class="cl">            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">avg_loss</span> <span class="o">=</span> <span class="n">running_loss</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Epoch [</span><span class="si">{</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">num_epochs</span><span class="si">}</span><span class="s2">], Loss: </span><span class="si">{</span><span class="n">avg_loss</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 主程式</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 設置路徑</span>
</span></span><span class="line"><span class="cl">    <span class="n">video_dir</span> <span class="o">=</span> <span class="s2">&#34;videos&#34;</span>  <span class="c1"># 包含影片的目錄</span>
</span></span><span class="line"><span class="cl">    <span class="n">yuv420_dir</span> <span class="o">=</span> <span class="s2">&#34;./frames&#34;</span>  <span class="c1"># 保存提取幀的目錄</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 提取影片幀</span>
</span></span><span class="line"><span class="cl">    <span class="n">extract_frames_from_videos</span><span class="p">(</span><span class="n">video_dir</span><span class="p">,</span> <span class="n">yuv420_dir</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 加載數據集</span>
</span></span><span class="line"><span class="cl">    <span class="n">dataset</span> <span class="o">=</span> <span class="n">VideoYUV420Dataset</span><span class="p">(</span><span class="n">yuv420_dir</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 定義模型、損失函數與優化器</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">YUV420ToYUV444Model</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 訓練模型</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

     
    
        
    

    <footer class="site-footer">
  <section class="copyright">
    &copy;  2024 -  2025 David Chen
  </section>

  <section class="powerby">
    使用 <a
      href="https://gohugo.io/"
      target="_blank"
      rel="noopener"
      >Hugo</a
    > 建立
    <br />
    主題 <b
      ><a
        href="https://github.com/CaiJimmy/hugo-theme-stack"
        target="_blank"
        rel="noopener"
        data-version="3.29.0"
        >Stack</a
      ></b
    > 由 <a
      href="https://jimmycai.com"
      target="_blank"
      rel="noopener"
      >Jimmy</a
    > 設計
  </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.a870c7b6951e386abd098cdcfc94939f97f8d538f907eabb4bc60225ebd71565.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<script
    src="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/js/ribbon.min.js"
    integrity="sha384-UEK8ZiP3VgFNP8KnKMKDmd4pAUAOJ59Y2Jo3ED2Z5qKQf6HLHovMxq7Beb9CLPUe"
    crossorigin="anonymous"
    size="300"
    alpha="0.6"
    zindex="-1"
    defer
></script>

    </body>
</html>
